<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹´í˜ ì¶”ê°€</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

    <!-- âœ… ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <nav>
        <div class="logo">
            <a href="/"><h1>â˜• Cafe & Wifi API</h1></a>
        </div>
        <ul class="nav-links">
            <li><a href="/">ğŸ  í™ˆ</a></li>
            <li><a href="/add">â• ì¹´í˜ ì¶”ê°€</a></li>
            <li><a href="/update">âœï¸ ì •ë³´ ìˆ˜ì • ìš”ì²­</a></li>
            <li><a href="/login">ğŸ› ï¸ ê´€ë¦¬ì ë¡œê·¸ì¸</a></li>
        </ul>
    </nav>

    <!-- âœ… ì¹´í˜ ì¶”ê°€ í¼ -->
    <section id="add-cafe-section">
        <h2>â• ìƒˆ ì¹´í˜ ë“±ë¡</h2>
        <p>ì¹´í˜ ì •ë³´ë¥¼ ì…ë ¥í•œ í›„ ë“±ë¡í•˜ì„¸ìš”.</p>

        <form id="add-cafe-form">
            <label for="name">ì¹´í˜ ì´ë¦„</label>
            <input type="text" id="name" name="name" placeholder="ì˜ˆ: ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì " required>

            <label for="map_url">ì§€ë„ URL</label>
            <input type="text" id="map_url" name="map_url" placeholder="ì§€ë„ ë§í¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>

            <label for="img_url">ì´ë¯¸ì§€ URL</label>
            <input type="text" id="img_url" name="img_url" placeholder="ì¹´í˜ ì´ë¯¸ì§€ ë§í¬" required>

            <label for="location">ìœ„ì¹˜</label>
            <input type="text" id="location" name="location" placeholder="ì˜ˆ: ì„œìš¸ ê°•ë‚¨êµ¬" required>

            <label for="coffee_price">ì»¤í”¼ ê°€ê²©</label>
            <input type="text" id="coffee_price" name="coffee_price" placeholder="ì˜ˆ: 4,500ì›" required>

            <label for="seats">ì¢Œì„ ìˆ˜</label>
            <input type="number" id="seats" name="seats" placeholder="ì¢Œì„ ê°œìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>

            <div class="checkbox-group">
                <label><input type="checkbox" name="has_wifi"> ì™€ì´íŒŒì´</label>
                <label><input type="checkbox" name="has_sockets"> ì½˜ì„¼íŠ¸</label>
                <label><input type="checkbox" name="has_toilet"> í™”ì¥ì‹¤</label>
                <label><input type="checkbox" name="can_take_calls"> í†µí™”</label>
            </div>

            <button type="submit">ì¹´í˜ ì¶”ê°€</button>
        </form>
    </section>

    <script>
        document.getElementById("add-cafe-form").onsubmit = async function(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData.entries());

            // âœ… ì²´í¬ë°•ìŠ¤ ê°’ì´ í¬í•¨ë˜ë„ë¡ Boolean ê°’ ë³€í™˜
            data.has_wifi = formData.get("has_wifi") ? true : false;
            data.has_sockets = formData.get("has_sockets") ? true : false;
            data.has_toilet = formData.get("has_toilet") ? true : false;
            data.can_take_calls = formData.get("can_take_calls") ? true : false;

            const response = await fetch("/cafes", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                alert("ì¹´í˜ ì¶”ê°€ ì™„ë£Œ!");
                window.location.href = "/"; // í™ˆìœ¼ë¡œ ì´ë™
            } else {
                alert("ì¶”ê°€ ì‹¤íŒ¨: " + (await response.json()).error);
            }
        };
    </script>

</body>
</html>
